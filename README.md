# car_dist_by_photo_22
 hacks-ai 22. ulyan obl. determine car distance
 https://hacks-ai.ru/championships/758259

 Задача: разработать алгоритм,
 позволяющий определить дистанцию до впереди идущего автомобиля,
 используя для этого датасет фотографий автомобилей с разного расстояния.
 Впоследствии этот алгоритм может быть использован в системах навигации
 для предупреждения об опасном сближении и для контроля за
 соблюдением дистанции.
 
 Метрика: R2
 
 
  Оглавление:
 - Описание решения
 - Итог
 - Структура директорий проекта
 - Выполнение
 
 
 
 
 ОПИСАНИЕ РЕШЕНИЯ.
 
 Финальное решение построено на детекции положения номера автомобиля и его линейных размерах.
 Используется модель https://github.com/dennisbappert/pytorch-licenseplate-segmentation/blob/master/README.md
 (model_v2.pth). Она на изображении определяет пиксели, относящиеся к автомобильному номеру и
 возвращает облако точек их координат. Из них беру мин и макс значения x и y и по ним определяю линейные размеры
 автомобильного номера. Линейные размеры преобразовываю через log.
 Модель catboost. CV на 3 фолда, по ним определяю оптимальное количество итераций (дабы избежать переобучения) по
 минимальной RMSE на валидационных фолдах. На этом оптимальном колчестви итераций обучаю catboostregressor на
 всех данных за исключением 3х сильно размытых изображений, на котором не представлется возможным определить хоть
 сколько-нибудь точно положение и размер автомобильного номера на них.
 
 
 
 
 ИТОГ
 
 0.9015 на паблике и 19е место
 0.9358 на привате и 9е место
 
 
 
 
 СТРУКТУРА ДИРЕКТОРИЙ ПРОЕКТА
 
  ═╦══data══╦══test══*.jpg $ *.heic
   ║        ║
   ║        ╠══train══*.jpg $ *.heic
   ║        ║
   ║        ╠══train.csv
   ║        ║
   ║        ╚═══test.csv
   ║
   ╠══models══*.cb
   ║
   ╚══subm══╦══*.csv
            ║
            ╚══partial══*.csv
 
 В data лежат исходные train.csv и test.csv.
 
 В data/test и data/train исходные изображения.
 
 В models сохраняются обученная(-ые) модель(-и)
 
 В subm сохраняется(-ются) сабмит(-ы)
 
 В subm/partias сохраняется(-ются) предсказанные значения для train выборки для анализа
 
 
 
 
 ВЫПОЛНЕНИЕ
 
 В первую очередь утснавливаются библиотеки из requirements.txt
 pip install -r /path/to/requirements.txt
 
 Дале выполняется следующая последовательность:
 0. 2_0step_make_features.ipynb в котором определяется рамка целевой автомашины
 1. 2_1step_make_features_lp.ipynb в котором внутри части изображения, ограниценного рамкой,
    найденной в п.0, находится облако точек автомобильного номера и определяются его линейные
    размеры
 2. 3step_modeling_catboost.ipynb в котором производится рассчет оптимального кол-ва итераци 
    по CV. Построение модели.
 3. (при желании) 5step_error_check.ipynb - отображение 5 изображений самых больших (по модулю) 
    ошибок
